<?php $pdo = new PDO("pgsql:host=192.168.6.146;port=5432;dbname=mercados", "refact", "FF)-BQk2", [PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION]); $sps = ["sp_rpt_ingresos_locales", "sp_rpt_ingresos_energia", "sp_rpt_pagos_caja", "sp_rpt_pagos_detalle", "sp_rpt_pagos_grl", "sp_estadistica_pagos_adeudos", "sp_listar_adeudos_energia"]; echo "Verificando firmas de SPs:\n\n"; foreach ($sps as $sp) { $check = $pdo->query("SELECT EXISTS (SELECT 1 FROM pg_proc p JOIN pg_namespace n ON p.pronamespace = n.oid WHERE n.nspname = 'public' AND p.proname = '$sp')")->fetchColumn(); if ($check) { $info = $pdo->query("SELECT pg_get_function_identity_arguments(p.oid) as args FROM pg_proc p JOIN pg_namespace n ON p.pronamespace = n.oid WHERE n.nspname = 'public' AND p.proname = '$sp'")->fetch(); echo "✅ $sp(" . ($info['args'] ?: 'no params') . ")\n"; } else { echo "❌ $sp NO EXISTE\n"; } } ?>
